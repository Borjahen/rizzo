"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var handleFavicon_1 = require("../../middleware/handleFavicon");
describe("handleFavicon", function () {
    var writeHeadMock;
    var endMock;
    var requestMock;
    var responseMock;
    var nextMock;
    beforeEach(function () {
        writeHeadMock = jest.fn();
        endMock = jest.fn();
        responseMock = {
            writeHead: writeHeadMock,
            end: endMock,
        };
        nextMock = jest.fn();
    });
    afterEach(function () {
        writeHeadMock.mockReset();
        endMock.mockReset();
        nextMock.mockReset();
    });
    it("should call next if request isn't a favicon", function () {
        requestMock = {
            url: "path/favicon.ico/image.jpg",
        };
        handleFavicon_1.default(requestMock, responseMock, nextMock);
        expect(nextMock).toHaveBeenCalledTimes(1);
    });
    it("should call next if request is a favicon", function () {
        requestMock = {
            url: "path/favicon.ico",
        };
        handleFavicon_1.default(requestMock, responseMock, nextMock);
        expect(writeHeadMock).toHaveBeenCalledWith(200, { "Content-Type": "image/x-icon" });
        expect(endMock).toHaveBeenCalledTimes(1);
        expect(nextMock).toHaveBeenCalledTimes(0);
    });
});
